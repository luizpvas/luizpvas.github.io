<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tracking visits with image tags</title>
    <link rel="stylesheet" href="index.css" />

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7TMTHS88G9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-7TMTHS88G9');
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/haskell.min.js"></script>

    <style>
      .prose :where(code):not(:where([class~="not-prose"] *))::before {
        content: "";
      }
      .prose :where(code):not(:where([class~="not-prose"] *))::after {
        content: "";
      }
    </style>
  </head>
  <body class="bg-slate-100">
    <main class="max-w-[960px] mx-auto pt-4">
      <div class="mx-4 lg:mx-0">
        <a href="index.html" class="inline-flex border border-gray-300 items-center bg-slate-50 hover:bg-white hover:border-black px-3 py-1 rounded-full">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />
          </svg>

          <span class="ml-1">All posts</span>
        </a>

        <div class="mb-4">
          <h1 class="my-6 text-5xl tracking-tight">Tracking visits with image tags</h1>
          <div class="text-slate-500 my-2">Published on 2023-10-06</div>
        </div>
      </div>

      <div class="prose lg:prose-xl mb-12 bg-white shadow-lg rounded-xl mx-auto max-w-[960px] p-8">
        <p>Have you ever noticed analytics services such as Google Analytics, Fathom, Mixpanel and Hotjar use an <code>&lt;img&gt;</code> tag to track visits? Even when there&#39;s an integration script, the script dynamically builds an image element instead of directly sending AJAX requests.
There are three good reasons for this:</p>

<ol>
<li><strong>Images skip preflight CORS requests.</strong> Analytics trackers are designed to run on other people&#39;s websites. Browsers know when you&#39;re sending a request to a domain other than the one you&#39;re currently visiting, and when that happens a preflight OPTIONS request is sent to make sure the server accepts the request. One OPTIONS request plus the actual request you wanted to send. We can cut the amount of requests in half by using an image.</li>
<li><strong>Images can be used in emails.</strong></li>
<li><strong>Browser compability</strong>. The <code>fetch</code> API is pretty widespread, but <code>&lt;img&gt;</code> tags just work everywhere.</li>
</ol>

      </div>
    </main>

    <script>hljs.highlightAll();</script>
  </body>
</html>
